:root{
  --bg:#0f0f14;
  --card:#161822;
  --text:#f3f5ff;
  --muted:#a9b0cc;
  --accent:#ff5d8f;
  --accent-2:#ffd166;
}

*{ box-sizing:border-box; }
html,body{ height:100%; }
body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
  color:var(--text);
  background: radial-gradient(1200px 800px at 50% -20%, #2a2d43 0%, #171925 40%, var(--bg) 100%);
  display:flex; flex-direction:column; align-items:center;
  -webkit-tap-highlight-color: transparent;
}

.top{ text-align:center; padding:20px 12px 8px; }
h1{ margin:0 0 8px; font-weight:800; letter-spacing:.2px; }
.hint{ margin:.25rem 0 .8rem; color:var(--muted); font-size:0.98rem; }

.controls{
  display:flex; gap:.6rem; align-items:center; justify-content:center;
  flex-wrap:wrap; row-gap:.4rem;
}
.btn{
  appearance:none; border:none; border-radius:999px;
  padding:.7rem 1.1rem; font-weight:700; cursor:pointer;
  background:linear-gradient(135deg, var(--accent) 0%, #ff8ba7 100%);
  color:#1a0f16; box-shadow: 0 6px 20px rgba(255,93,143,.35);
}
.btn:disabled{ opacity:.65; cursor:not-allowed; }
.btn.ghost{
  background:transparent; color:var(--text); border:1px solid #ffffff22; box-shadow:none;
}

.levelWrap{
  display:flex; align-items:center; gap:.4rem;
}
.levelLabel{ font-size:.85rem; color:var(--muted); }
.level{
  display:inline-block; width:160px; height:12px; border-radius:999px;
  background:#ffffff14; position:relative; overflow:hidden;
}
.level .fill{
  position:absolute; left:0; top:0; bottom:0; width:0%;
  background:linear-gradient(90deg, #6ee7ff, var(--accent-2));
  transition: width .08s linear;
  border-radius:999px;
}

.sensWrap{
  display:flex; align-items:center; gap:.35rem; background:#ffffff12;
  padding:.35rem .5rem; border-radius:999px; border:1px solid #ffffff1a;
}
.sensLabel{ font-size:.85rem; color:var(--muted); }
#sens{
  appearance:none; background:transparent; color:var(--text);
  border:none; font-weight:600; padding:.2rem .2rem; cursor:pointer;
}

.status, .remaining{ margin:.5rem 0 0; }
.status strong{ color:#9ae6b4; }

main{ width:100%; display:flex; justify-content:center; padding:8px 12px 40px; }

#cakeArea{ position:relative; margin-top:8px; }
.cake{
  position:relative; width:min(96vw, 820px); height:min(70vw, 380px);
  background: linear-gradient(#fbc6d0, #ffb3c1);
  border-radius: 16px 16px 60px 60px / 14px 14px 48px 48px;
  box-shadow: 0 12px 40px rgba(0,0,0,.35), inset 0 -16px 0 #e78da0;
  padding-top: 140px;
}
.cake::before{
  content:""; position:absolute; left:0; right:0; top:0; height:120px;
  background:
     radial-gradient(18px 14px at 10% 22%, #fff 99%, #0000 100%),
     radial-gradient(24px 16px at 24% 30%, #fff 99%, #0000 100%),
     radial-gradient(20px 14px at 40% 24%, #fff 99%, #0000 100%),
     radial-gradient(22px 15px at 55% 32%, #fff 99%, #0000 100%),
     radial-gradient(16px 12px at 70% 26%, #fff 99%, #0000 100%),
     radial-gradient(20px 15px at 86% 28%, #fff 99%, #0000 100%),
     linear-gradient(#fff, #f6f6f6);
  border-radius:16px 16px 0 0;
  box-shadow: inset 0 -2px 0 #e7e7e7;
}

.plate{
  width: min(98vw, 860px); height: 24px; margin: 14px auto 0;
  border-radius: 999px;
  background: radial-gradient(70% 140% at 50% -40%, #fff 0 45%, #c8d0ea 46% 100%);
  box-shadow: 0 30px 60px rgba(0,0,0,.5);
}

.candles{
  position:absolute; top: 52px; left: 50%; transform: translateX(-50%);
  width: 92%; display: grid; grid-template-columns: repeat(21, 1fr);
  gap: clamp(5px, 1.1vw, 14px);
  align-items:end;
}
@media (max-width:560px){
  .candles{ width: 88%; gap: clamp(4px, 1.8vw, 10px); }
}

.candle{ position:relative; width: clamp(12px, 2.2vw, 16px); height: 86px; margin: 0 auto; touch-action: manipulation; }
.stick{
  width: 100%; height: 68px; border-radius: 4px;
  background: repeating-linear-gradient(45deg, #ff86a6 0 8px, #ffd8e3 8px 16px);
  box-shadow: inset 0 -4px 0 #ea6e93;
}
.wick{
  position:absolute; top:-10px; left:50%; transform:translateX(-50%);
  width:2px; height:12px; background:#1c1c1c; border-radius:2px;
}
.flame{
  position:absolute; top:-28px; left:50%; transform: translateX(-50%);
  width:18px; height:28px; border-radius:50%;
  background: radial-gradient(60% 80% at 50% 20%, #fffad7 0%, #ffd166 35%, #ff8f00 60%, #ff5d00 100%);
  filter: drop-shadow(0 0 6px #ff9b00) drop-shadow(0 0 12px #ff6a00);
  animation: flicker .14s infinite alternate ease-in-out;
  transform-origin: bottom center;
}
@keyframes flicker{
  from { transform: translateX(-50%) scale(1) rotate(-2deg); opacity:.92; }
  to   { transform: translateX(-50%) scale(1.05) rotate(2deg); opacity:1; }
}
.candle.out .flame{ display:none; }
.candle.out .stick{ filter: grayscale(.3) brightness(.9); }
.candle.out .wick{ background:#555; }

.overlay{
  position: fixed; inset:0; display:grid; place-items:center;
  background: rgba(0,0,0,.6); backdrop-filter: blur(6px);
  animation: fadeIn .4s ease forwards;
}
.overlay[hidden]{ display:none; }
@keyframes fadeIn{ from{opacity:0} to{opacity:1} }

.message-card{
  position: relative;
  background: linear-gradient(160deg, #1a1e2c, #0e1220);
  border: 1px solid #ffffff22; color: var(--text);
  padding: 24px 20px; border-radius: 16px;
  width:min(92vw, 560px); text-align:center;
  box-shadow: 0 20px 80px rgba(0,0,0,.6);
}
.message-card h2{ margin:.2rem 0 .6rem; font-size: clamp(1.6rem, 6vw, 2.1rem); }
.message-card p{ color:var(--muted); margin:.3rem 0 1.1rem; }

#confetti{ position: absolute; inset:0; width:100%; height:100%; pointer-events:none; }

.noscript{ background:#fff3cd; color:#3f2e00; padding:8px 12px; border-radius:8px; margin:12px; }
.foot{ margin: 12px 0 28px; color:#94a0c7; font-size:.9rem; }

/* iOS safe area */
@supports (padding: max(0px)){
  body{ padding-bottom: max(0px, env(safe-area-inset-bottom)); }
}
